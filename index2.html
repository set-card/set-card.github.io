<html>

<head>
    <title>Set Card</title>
</head>

<body>
    <h1>Prototype &lt;SET-CARD> Web Component</h1>
    <a href="https://yqnn.github.io/svg-path-editor/#M45,50h150v50h-150Z">https://yqnn.github.io/svg-path-editor/#</a>
    <script>
        let board = [];
        let i = 0;
        var score = 0;
        let select = [];
        customElements.define("set-card", class extends HTMLElement {
            constructor() {
                super().attachShadow({ mode: 'open' }).innerHTML = `<svg viewBox="0 0 275 375" xmlns="http://www.w3.org/2000/svg" xmlns:bx="https://boxy-svg.com">
                    <defs>
                        <bx:grid x="0" y="0" width="16" height="16"/>
                        <linearGradient gradientUnits="userSpaceOnUse" x1="43.5" y1="37" x2="43.5" y2="50" id="gradient-0" gradientTransform="matrix(0.702278, 0.711904, -0.860576, 0.858689, 38.36052, -39.786184)" spreadMethod="pad">
                        <stop offset="0" style="stop-color: rgb(69, 23, 41);"/>
                        <stop offset="1" style="stop-color: rgb(209, 0, 136);"/>
                        </linearGradient>
                        <linearGradient gradientUnits="userSpaceOnUse" x1="43.5" y1="37" x2="43.5" y2="50" id="gradient-1" gradientTransform="matrix(0.702278, 0.711904, -0.860576, 0.858689, 38.342392, 260.19577)" spreadMethod="pad">
                        <stop offset="0" style="stop-color: rgb(69, 23, 41);"/>
                        <stop offset="1" style="stop-color: rgb(209, 0, 136);"/>
                        </linearGradient>
                        <linearGradient gradientUnits="userSpaceOnUse" x1="43.5" y1="37" x2="43.5" y2="50" id="gradient-2" gradientTransform="matrix(0.702278, 0.711904, -0.860576, 0.858689, 245.321625, -39.810837)" spreadMethod="pad">
                        <stop offset="0" style="stop-color: rgb(69, 23, 41);"/>
                        <stop offset="1" style="stop-color: rgb(209, 0, 136);"/>
                        </linearGradient>
                        <linearGradient gradientUnits="userSpaceOnUse" x1="43.5" y1="37" x2="43.5" y2="50" id="gradient-3" gradientTransform="matrix(0.702278, 0.711904, -0.860576, 0.858689, 245.357605, 260.242676)" spreadMethod="pad">
                        <stop offset="0" style="stop-color: rgb(69, 23, 41);"/>
                        <stop offset="1" style="stop-color: rgb(209, 0, 136);"/>
                        </linearGradient>
                    </defs>
                    <rect width="239" height="333" rx="12" ry="12" stroke="#444" fill="#FEFEFE" fill-opacity="1" stroke-width="1" x="16" y="16" style="pointer-events: none;"/>
                    <rect width="220" height="310" x="26" y="26" ry="1" fill="url(#A)" fill-opacity="1 "/>
                    <text x="216" y="334" stroke="black" text-anchor="middle" opacity=".7" style="font-weight: 700; font-family: Arial; letter-spacing: 2px; fill: rgb(85, 85, 85); stroke: none; font-size: 8px; white-space: pre;">= .=</text>
                    
                    <path d="M 26.003 26.011 Z Z M 26.003 26.011 L 34.003 26.011 L 39.003 39.011 L 26.003 34.011 L 26.003 26.011 Z" style="fill: url(#gradient-0);" fill-opacity="1"/>
                    <path style="fill: rgb(79, 8, 41);" d="M 26.002 25.971 L 39.003 39.011 L 26.003 34.091 L 26.002 25.971 Z"/>
                    <path d="M 25.984 325.992 Z Z M 25.984 325.992 L 33.984 325.992 L 38.984 338.992 L 25.984 333.992 L 25.984 325.992 Z" style="fill: url(#gradient-1);" fill-opacity="1" transform="matrix(0, -1, 1, 0, -300.008005, 364.976002)"/>
                    <path style="fill: rgb(79, 8, 41);" d="M 26.02 325.972 L 39.021 339.012 L 26.021 334.092 L 26.02 325.972 Z" transform="matrix(0, -1, 1, 0, -299.971488, 365.012488)"/>
                    <path d="M 232.964 25.986 Z Z M 232.964 25.986 L 240.964 25.986 L 245.964 38.986 L 232.964 33.986 L 232.964 25.986 Z" style="fill: url(#gradient-2);" fill-opacity="1" transform="matrix(0, 1, -1, 0, 271.950006, -206.978004)"/>
                    <path style="fill: rgb(79, 8, 41);" d="M 232.984 25.966 L 245.985 39.006 L 232.985 34.086 L 232.984 25.966 Z" transform="matrix(0, 1, -1, 0, 271.970497, -206.998496)"/>
                    <path d="M 233 326.04 Z Z M 233 326.041  L 241 326.04 L 246 339.0 L 233 334.04 L 233 326.04 Z" style="fill: url(#gradient-3);" fill-opacity="1" transform="matrix(-1, 0, 0, -1, 478.999999, 665.080018)"/>
                    <path style="fill: rgb(79, 8, 41);" d="M 233 326.041 L 246.001 339.0 L 233.001 334.1 L 233 326.01 Z" transform="matrix(-1, 0, 0, -1, 479.001009, 665.121978)"/>
                    
                    <defs>
                        <pattern id="halfs" viewBox="0,0,10,10" width="10%" height="10%" fill="#fff" patternTransform='scale(0.5) rotate(45)'>
                            <rect x='0' y='0' width='10%' height='1.75%' />
                        </pattern>
                    </defs>
                    
                    <defs>
                        <pattern id="emptys" viewBox="0,0,10,10" width="10%" height="10%" fill="#fff" patternTransform='scale(40) rotate(135)'>
                            <rect x='0' y='0' width='10%' height='1.75%' />
                        </pattern>
                    </defs>

                    <g id="shapes">    
                    <path id="shape1" d="M45 50h150v50h-150 Z" fill="red" /> 
                    </g>
                </svg>`
            }
            get shapes() {
                return this.shadowRoot.querySelector("#shapes");
            }
            set shapes(svg) {
                this.shapes.innerHTML = svg;
            }
            connectedCallback() {

                // read attributes
                // create id=shapes inside svg
                let shape = {
                    1: 1,
                    2: 2,
                    3: 3,

                    /*"rect"*/4: `<rect transform="translate(0 0)" x="81" y="160" width="109" height="48" stroke="#000000" fill="#000000" stroke-width="3px" style=""/>`,
                    /*"wiggle"*/5: `<path transform="translate(0 0)" style="fill-rule: nonzero;" d="m81 190c51-69 51 9 112-17-52 77-52 0-112 17z" stroke="#000000" fill="#000000" stroke-width="3px" bx:origin="0.64 -1.137945"/>`,
                    /*"oval"*/6: `<ellipse transform="translate(0 0)" cx="136" cy="184" rx="55" ry="23.5" stroke="#000000" fill="#000000" stroke-width="3px" style=""/>`,

                    /*"red"*/7: "#e6196b",
                    /*"green"*/8: "#1dc973",
                    /*"blue"*/9: "#6666ff",

                    /*"fulls"*/10: ``,
                    /*"halfs"*/11: `<rect transform="translate(0 0)" x="61" y="60" width="150" height="250" fill="url(#halfs)" style=""/>`,
                    /*"emptys"*/12: `<rect transform="translate(0 0)" x="61" y="60" width="150" height="250" fill="url(#emptys)" style=""/>`
                }

/*randomizer en doublecheck*/
                function getRandomInt(max) {
                    return Math.floor(Math.random() * max) + 1;
                }
                let amount, shape1, color, filling, id;

                do {
                    amount = getRandomInt(3);
                    shape1 = getRandomInt(3) + 3;
                    color = getRandomInt(3) + 6;
                    filling = getRandomInt(3) + 9;
                    id = "CARD_" + amount + shape1 + color + filling;
                    console.log(amount, shape1, color, filling);
                } while (document.getElementById(id));

                this.setAttribute("amount", amount);
                this.setAttribute("shape1", shape1);
                this.setAttribute("color", color);
                this.setAttribute("filling", filling);
                this.id = id;
                board [i] = id;
                i++;
                console.log(board);
                // nu check of id al bestaat
                // zo ja, dan opnieuw maken
                // zo nee, dan is het goed
/**/
                
                let t = 0;
                let shapes;
                switch (shape[amount]) {
                    case 3:
                        shapes = shape[shape1].replace("0 0", "0 -75").replace(/#000000/g, shape[color]) +
                            shape[shape1].replace("0 0", "0 75").replace(/#000000/g, shape[color]) +
                            shape[shape1].replace(/#000000/g, shape[color]) +
                            shape[filling] +
                            shape[shape1].replace("0 0", "0 -75").replace(/#000000/g, match => ++t === 2 ? "rgba( 0, 0, 0, 0.0 )" : match).replace("#000000", shape[color]) +
                            shape[shape1].replace("0 0", "0 75").replace(/#000000/g, match => ++t === 4 ? "rgba( 0, 0, 0, 0.0 )" : match).replace("#000000", shape[color]) +
                            shape[shape1].replace(/#000000/g, match => ++t === 6 ? "rgba( 0, 0, 0, 0.0 )" : match).replace("#000000", shape[color]);

                        this.shapes = shapes;
                        break;

                    case 2:
                        shapes = shape[shape1].replace("0 0", "0 -37").replace(/#000000/g, shape[color]) +
                            shape[shape1].replace("0 0", "0 37").replace(/#000000/g, shape[color]) +
                            shape[filling] +
                            shape[shape1].replace("0 0", "0 -37").replace(/#000000/g, match => ++t === 2 ? "rgba( 0, 0, 0, 0.0 )" : match).replace("#000000", shape[color]) +
                            shape[shape1].replace("0 0", "0 37").replace(/#000000/g, match => ++t === 4 ? "rgba( 0, 0, 0, 0.0 )" : match).replace("#000000", shape[color]);

                        this.shapes = shapes;
                        break;

                    case 1:
                        shapes = shape[shape1].replace(/#000000/g, shape[color]) +
                            shape[filling] +
                            shape[shape1].replace("0 0", "0 0").replace(/#000000/g, match => ++t === 2 ? "rgba( 0, 0, 0, 0.0 )" : match).replace("#000000", shape[color]);

                        this.shapes = shapes;
                        break;
                }
                //red #e6196b
                //green #1dc973
                //blue #6666ff

                
                document.querySelectorAll("div > set-card").forEach(setCard => {
                    setCard.onclick = (evt) => {
                        let choice = board[evt.target.getAttribute("idx") - 1];

                        if (select.includes(choice)) {
                            console.warn("Already selected!");
                        } else {
                            select.push(choice);
                        }

                        if (select.length == 3) {
                            console.log(select);
                            if (SETcheck(select) == true){
                                score++;
                                document.getElementById('score').innerHTML = "Score: " + score;
                                console.log(score);

                                console.log("SET!");
                            }
                            select = [];
                        }
                    }
                })

                function SETcheck(selection){
                    let SET = 0;
                    const SETbits0 = selection[0].split("");
                    const SETbits1 = selection[1].split("");
                    const SETbits2 = selection[2].split("");

                    if((SETbits0[5] == SETbits1[5] && SETbits0[5] == SETbits2[5]) || (SETbits0[5] != SETbits1[5] && SETbits0[5] != SETbits2[5] && SETbits1[5] != SETbits2[5])){
                        SET = SET + 1;
                    } else {
                        console.warn("num!");
                    }
                    if((SETbits0[6] == SETbits1[6] && SETbits0[6] == SETbits2[6]) || (SETbits0[6] != SETbits1[6] && SETbits0[6] != SETbits2[6] && SETbits1[6] != SETbits2[6])){
                        SET = SET + 1;
                    } else {
                        console.warn("shap!");
                    }
                    if((SETbits0[7] == SETbits1[7] && SETbits0[7] == SETbits2[7]) || (SETbits0[7] != SETbits1[7] && SETbits0[7] != SETbits2[7] && SETbits1[7] != SETbits2[7])){
                        SET = SET + 1;
                    } else {
                        console.warn("col!");
                    }
                    if((SETbits0[9] == SETbits1[9] && SETbits0[9] == SETbits2[9]) || (SETbits0[9] != SETbits1[9] && SETbits0[9] != SETbits2[9] && SETbits1[9] != SETbits2[9])){
                        SET = SET + 1;
                    } else {
                        console.warn("fil!");
                    }
                    console.log(SET);
                    if (SET == 4){
                        return true;
                    } else{
                        return false;
                    }
                }

            }

        });
    </script>
    <style>
        /**{
            border-color: red;
            border-style: solid;
            border-width: 2px;
        }*/

        body{
            background: #222222;
        }

        title, h1, h3{
            color: #eee;
        }

        a{
            color: #eee;
        }
        a:hover{
            color: #00ffff;
        }

        .board {
            width: 1300px;
            margin-left: 10px;
            border: 4px solid #ff0062;
            padding-left: 125px;
            background: #222222;
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: 1fr 1fr 1fr 1fr;
        }

        set-card {
            display: inline-block;
            width: 200px;
            margin-right: 120px;
        }

        set-card:hover {
            border: 1px solid #ff0062;
        }

        .sidenav {
            height: 15%;

            width: 130px;
            position: fixed;
            z-index: 1;
            top: 20px;
            right: 10px;
            background: #eee;
            overflow-x: hidden;
            padding: 8px 0;
        }
        .sidenav div {
            padding: 6px 8px 6px 16px;
            text-decoration: none;
            font-size: 25px;
            color: #eee;
            display: block;
        }
        .sidenav #score{
            color: #064579;
        }

        .sidenav div:hover {
            color: #064579;
        }

    </style>

    <div class="sidenav">
        <div id= "score"></div> 
        <script>
        document.getElementById('score').innerHTML = "Score: " + score;
        </script>
        
        <div>SET!</div>
    </div>
    <div class="board">
        <set-card idx = "1" shape1 amount color filling></set-card>
        <set-card idx = "2" shape1 amount color filling></set-card>
        <set-card idx = "3" shape1 amount color filling></set-card>

        <set-card idx = "4" shape1 amount color filling></set-card>
        <set-card idx = "5" shape1 amount color filling></set-card>
        <set-card idx = "6" shape1 amount color filling></set-card>

        <set-card idx = "7" shape1 amount color filling></set-card>
        <set-card idx = "8" shape1 amount color filling></set-card>
        <set-card idx = "9" shape1 amount color filling></set-card>

        <set-card idx = "10" shape1 amount color filling></set-card>
        <set-card idx = "11" shape1 amount color filling></set-card>
        <set-card idx = "12" shape1 amount color filling></set-card>
    </div>

    <h3>For: Niels de Jong</h3> 
</body>

</html>